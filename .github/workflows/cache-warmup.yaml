name: Cache Warmup

on:
  workflow_dispatch:
  push:
    tags:
      - 'v*'  # Runs on tags like v1.0.0; adjust as needed (e.g., add branches: main)

jobs:
  warmup:
    runs-on: ubuntu-latest  # Use ubuntu-latest for best compatibility; can switch to windows-latest or macos-latest if needed
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4  # Checks out your repo code (required for any local config files)

      - name: Setup PHP
        uses: shivammathur/setup-php@v2
        with:
          php-version: '8.3'  # Use your project's PHP version (e.g., 8.1, 8.2); must be 8.0+
          coverage: none  # Disables code coverage to speed up; set to 'xdebug' if needed for testing
          extensions: none  # Add extensions like 'curl' if your project requires them (usually not needed here)

      - name: Warm up caches
        id: warmup  # Optional: Gives this step an ID for referencing outputs later
        uses: eliashaeussler/cache-warmup-action@v1  # Pin to v1 for stability; update as new versions release
        with:
          version: latest  # Updated: Uses 4.3.2+ for config support; alternatively, use '^4.3'
          sitemaps: |
            https://dgnv.ir/maps/index.xml
          limit: 1300
          config: cache-warmup.json  # Your config file path
