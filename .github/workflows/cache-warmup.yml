name: Cache Warmup

on:
  workflow_dispatch:
  schedule:
    - cron: '17 0,2,4,6,8,10,12,14,16,18,20,22 * * *'
  pull_request:
    branches:
      - main
  push:
    branches:
      - '**'
    tags:
      - '**'  # Runs on tags like v1.0.0; adjust as needed (e.g., add branches: main)

jobs:
  warmups:
    runs-on: ubuntu-latest  # Use ubuntu-latest for best compatibility; can switch to windows-latest or macos-latest if needed
    permissions:
      contents: read
      packages: write
    timeout-minutes: 1
    steps:
     - name: Checkout repository
       uses: actions/checkout@v5
       with:
          fetch-depth: 0

     - name: Setup PHP
       uses: shivammathur/setup-php@v2
       with:
          #php-version: latest  # Matches your original; test file uses 8.4 for stable, but 8.3 is fine (â‰¥8.1)
          php-version: 8.3
          coverage: none  # Disables code coverage to speed up; set to 'xdebug' if needed for testing
          extensions: simplexml, curl, xml  # Add extensions like 'curl' if your project requires them (usually not needed here)

     - name: Warm up caches
       id: warmup  # Optional: Gives this step an ID for referencing outputs later
       uses: eliashaeussler/cache-warmup-action@v1  # Pin to v1 for stability; update as new versions release
       with:
          version: latest # Fixed: Uses the stable version from the test file for config support
          # sitemaps: |
          #  - https://dgnv.ir/maps/index.xml
          limit: 2
          progress: true  # Added for visibility, as in test file examples
          verbosity: vvv  # Added for detailed debugging, as in test file
          config: cache-warmup.json  # Your config file path
